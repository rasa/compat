name: build-most

on:
  workflow_call:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  build-ubuntu:
    uses: ./.github/workflows/build-ubuntu.yml
    secrets: inherit
  build-all-windows:
    uses: ./.github/workflows/build-all-windows.yml
    if: success()
    needs: build-ubuntu
    secrets: inherit
  build-only-macos:
    uses: ./.github/workflows/build-only-macos.yml
    if: success()
    needs: build-all-windows
    secrets: inherit
  build-only-nocgo:
    uses: ./.github/workflows/build-only-nocgo.yml
    with:
      goarches: all
    needs: build-only-macos
    if: success()
    secrets: inherit
  build-only-android:
    uses: ./.github/workflows/build-only-android.yml
    needs: build-only-nocgo
    if: success()
    secrets: inherit
  build-only-ios:
    uses: ./.github/workflows/build-only-ios.yml
    needs: build-only-android
    if: success()
    secrets: inherit
